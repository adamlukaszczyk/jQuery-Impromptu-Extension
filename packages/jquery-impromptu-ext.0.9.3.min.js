/*
 * jQuery Impromptu Extension
 * Copyright 2010 John Dobiatowski
 * Attribution-ShareAlike 3.0 Unported
 * http://creativecommons.org/licenses/by-sa/3.0/
 */
(function(a){a.prompt.submit=function(c){var b=a.prompt.getCurrentState();var f=b.children("."+a.prompt.tempOptions.prefix+"message");var g={};var d=a("#"+a.prompt.currentPrefix);a.each(d.find("#"+a.prompt.tempOptions.prefix+"states :input").serializeArray(),function(h,j){if(g[j.name]===undefined){g[j.name]=j.value}else{if(typeof g[j.name]==Array||typeof g[j.name]=="object"){g[j.name].push(j.value)}else{g[j.name]=[g[j.name],j.value]}}});var e=a.prompt.tempOptions.submit(c,f,g);if(e===undefined||e){a.prompt.close()}};a.prompt.tempOptions;a.promptExt=function(f,d){var e=window.screen.deviceXDPI;if(typeof(e)!="undefined"&&e!=96){d.overlayspeed=0;d.promptspeed=0;d.show="show"}a.prompt.tempOptions=a.extend({},a.prompt.defaults,d);if(a("#"+a.prompt.tempOptions.prefix).length!=0){a.prompt.close();setTimeout(function(){a.promptExt(f,d)},250);return}a.prompt(f,d);var c;var g=function(h){if(h.keyCode==13){setTimeout(function(){b(h)},0)}else{a.promptExt.oldInputValue=h.currentTarget.value}};var b=function(h){if(a.promptExt.oldInputValue==h.currentTarget.value){a.prompt.submit(h.currentTarget.form.name)}else{a.promptExt.oldInputValue=h.currentTarget.value}};a("#"+a.prompt.tempOptions.prefix+"states form").submit(function(){return false});a("#"+a.prompt.tempOptions.prefix+"states ."+a.prompt.tempOptions.prefix+"message :input").bind("keyup focus",g)}})(jQuery);